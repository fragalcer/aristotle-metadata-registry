{% extends "groups/base.html" %}
{% load group_tags i18n %}

{% block title %}Membership list | {{ stewardship_organisation }}{% endblock %}
{% block page_title %}
{{ group.name }} | Editing members
{% endblock %}


{% block group_content %}

<div>
{% if group.allows_multiple_roles %}
    {% trans "This group allows members to have multiple roles" %}
{% else %}
    {% trans "This group allows members to have a single role" %}
{% endif %}
</div>
<a href="{%url view.manager.namespace|add:":member_add" group.slug %}">Add member</a>

<table class="table">
    <thead>
        <tr>
            <th>Member</th>
            <th>
                {% if group.allows_multiple_roles %}
                    {% trans "Current Roles" %}
                {% else %}
                    {% trans "Current Role" %}
                {% endif %}
            </th>
            <th>Change</th>
        </tr>
    </thead>
    <tbody>

    
        {% regroup object_list.all by user as member_list %}
        {% for member in member_list %}
        {% with member_user=member.grouper %}
        <tr>
            <td>
                {% if member.grouper == request.user %}
                    <a href="{% url 'aristotle_mdr:userProfile' %}">
                        {{ member.grouper.display_name }}
                        ({% trans "You" %})
                    </a>                
                {% else %}
                    <a title='{% trans "View profile" %}' href="{% url 'aristotle-user:view_another_user' member.grouper.pk %}">
                        {{ member.grouper.display_name }}
                    </a>
                {% endif %}

            </td>
            <td>
                {% if group.allows_multiple_roles %}
                    <ul>
                    {% for membership in member.list %}
                        <li>{{membership.role}}</li>
                    {% endfor %}
                    </ul>
                {% else %}
                    {% for membership in member.list %}
                        {{membership.role}}
                    {% endfor %}
                {% endif %}
            </td>
            <td>
                <a href="{%url view.manager.namespace|add:":membership_update" group.slug member.grouper.pk %}">Change role</a>
            </td>
            <td>
                <a href="{%url view.manager.namespace|add:":membership_remove" group.slug member.grouper.pk %}">Remove</a>
            </td>
        </tr>
        {% endwith %}
        {% endfor %}
    </tbody>
</table>
{% endblock %}
