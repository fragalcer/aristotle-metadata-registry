{% extends "groups/base.html" %}
{% load group_tags i18n %}

{% block group_content %}
<h1>
    Editing members {{group.name}}
</h1>

<div>
{% if group.allows_multiple_roles %}
    {% trans "This group allows members to have multiple roles" %}
{% else %}
    {% trans "This group allows members to a single roles" %}
{% endif %}
</div>
<a href="{%url view.manager.namespace|add:":member_add" group.slug %}">Add member</a>

<table>
    <thead>
        <tr>
            <th>Member</th>
            <th>
                {% if group.allows_multiple_roles %}
                    {% trans "Current Roles" %}
                {% else %}
                    {% trans "Current Role" %}
                {% endif %}
            </th>
            <th>Change</th>
        </tr>
    </thead>
    <tbody>

    
        {% regroup object_list.all by user as member_list %}
        {% for member in member_list %}
        {% with member_user=member.grouper %}
        <tr>
            <td>
                {{ member.grouper.display_name }}
                {% if member.grouper == request.user %}
                    ({% trans "You" %})
                {% endif %}
            </td>
            <td>
                {% if group.allows_multiple_roles %}
                    <ul>
                    {% for membership in member.list %}
                        <li>{{membership.role}}</li>
                    {% endfor %}
                    </ul>
                {% else %}
                    {% for membership in member.list %}
                        {{membership.role}}
                    {% endfor %}
                {% endif %}
            </td>
            <td>
                <a href="{%url view.manager.namespace|add:":membership_update" group.slug member.grouper.pk %}">Change role</a>
            </td>
            <td>
                <a href="{%url view.manager.namespace|add:":membership_remove" group.slug member.grouper.pk %}">Remove</a>
            </td>
        </tr>
        {% endwith %}
        {% endfor %}
    </tbody>
</table>
{% endblock %}
